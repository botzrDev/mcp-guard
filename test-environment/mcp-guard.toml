# MCP Guard Configuration
# Generated by: mcp-guard init
# Documentation: https://github.com/botzrdev/mcp-guard

[server]
host = "127.0.0.1"
port = 3000

# Authentication - Demo API key (replace in production!)
[[auth.api_keys]]
id = "demo-user"
key_hash = "kSy8yCtXeILvHv0Qdo8sQMDJmxTUPx9ZTC6mgRcEVGs="
allowed_tools = []  # Empty = all tools allowed
rate_limit = 100

[[auth.api_keys]]
id = "test-agent"
key_hash = "zmnxwf2T7YTx2Pq3Xl2EaIgwI+hMJcXhhtP+QjdBeHM="
allowed_tools = []

# Restricted user - can only read files and list directories
[[auth.api_keys]]
id = "read-only-user"
key_hash = "LSLMUlABjS3dPMq07XcaF1W14U5GD+mqTOKrJKvu/dc="
allowed_tools = ["read_file", "list_directory"]
rate_limit = 100

# Low rate limit user - for testing rate limiting
[[auth.api_keys]]
id = "low-rate-user"
key_hash = "9IXAjZosMslHqEGOTsQkOu8Iyzw7TjCRkzEYJ4oZ+6Y="
allowed_tools = []
rate_limit = 2  # Very low limit for testing

# Generate production keys with: mcp-guard keygen --user-id <name>

# JWT Authentication (Simple Mode - HS256)
[auth.jwt]
mode = "simple"
secret = "mcp-guard-test-secret-key-32-chars!!"
issuer = "https://test.mcp-guard.io"
audience = "mcp-guard"
user_id_claim = "sub"
scopes_claim = "scope"

# Scope-to-Tool mapping for JWT users
[auth.jwt.scope_tool_mapping]
"read:files" = ["read_file", "list_directory"]
"write:files" = ["write_file", "create_directory"]
"admin" = ["*"]


[rate_limit]
enabled = true
requests_per_second = 100
burst_size = 50

[audit]
enabled = true
stdout = true

[upstream]
transport = "stdio"
command = "npx"
args = ["-y", "@modelcontextprotocol/server-filesystem", "/tmp"]

# Multi-Server Routing (Requires Enterprise)
# [[upstream.servers]]
# ...


# Full configuration reference with all options:
# https://github.com/botzrdev/mcp-guard/blob/main/templates/mcp-guard.toml
